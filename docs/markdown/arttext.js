/*! ArtText v0.0.0 */!function(e){var t={};function o(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.m=e,o.c=t,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=0)}([function(e,t,o){"use strict";o.r(t);var n,i=function(e){this.nodeName=e},r=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(e,t)},function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}),s=function(e){function t(t){var o=e.call(this,"#text")||this;return o.text=t,o.parentNode=null,o.dom=null,o}return r(t,e),t.prototype.newDom=function(){return this.dom=document.createTextNode(this.text),this.dom},t.prototype.getMd=function(){return this.text},t.prototype.getText=function(){return this.text},t}(i);function l(e){e.innerHTML="",e.setAttribute("style","width:100%;visibility:hidden;font-size:14px;position:relative;margin-bottom: 2px;");var t=document.createElement("input");t.setAttribute("style","width:35px;margin:0 7px;;font-size:14px;font-weight: 600;color: #1abc9c;border: none;outline: none;"),t.title="调整行";var o=document.createElement("input");o.setAttribute("style","width:35px;font-size:14px;font-weight: 600;color: #1abc9c;border: none;outline: none;"),o.title="调整列";var n=document.createElement("span");n.style.display="none",n.appendChild(t),n.appendChild(o);var i=document.createElement("span");i.setAttribute("style","width:30px;cursor:pointer;"),i.innerHTML='<svg class="icon" style="width: 18px; height: 18px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1283"><path d="M64.021106 512c0-17.672498 14.07353-31.998785 31.887244-31.998785h832.182277c17.6111 0 31.887244 14.202467 31.887244 31.998785 0 17.672498-14.07353 31.998785-31.887244 31.998785H95.909373c-17.6111 0-31.888268-14.20349-31.888267-31.998785zM959.977871 352.007099c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V160.016437c0-17.672498-14.326287-31.998785-31.998784-31.998785H160.016437c-17.672498 0-31.998785 14.326287-31.998785 31.998785v191.990662c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V160.016437c0-53.016471 42.97886-95.995331 95.995332-95.995331H863.981517c53.016471 0 95.995331 42.97886 95.995331 95.995331v191.990662z m0 319.984779v191.990662c0 53.016471-42.97886 95.995331-95.995331 95.995331H160.016437c-53.016471 0-95.995331-42.97886-95.995331-95.995331V671.991878c0-17.672498 14.326287-31.998785 31.998785-31.998785s31.998785 14.326287 31.998784 31.998785v191.990662c0 17.672498 14.326287 31.998785 31.998785 31.998785h703.966103c17.672498 0 31.998785-14.326287 31.998785-31.998785V671.991878c0-17.672498 14.326287-31.998785 31.998785-31.998785s31.996738 14.32731 31.996738 31.998785z" p-id="1284"></path></svg>',i.title="调整大小",i.onclick=d,i.appendChild(n);var r=document.createElement("span");r.setAttribute("style","position:absolute;right:0;cursor:pointer;"),r.innerHTML='<svg class="icon" style="width: 18px; height: 18px;color: red;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="689"><path d="M800.162002 316.659033c1.850138-17.575284 17.596773-30.322609 35.172058-28.473495 17.575284 1.850138 30.322609 17.596773 28.473494 35.172058l-57.966202 550.673811c-5.143137 48.856731-46.341445 85.946464-95.467306 85.946464H313.625954c-49.126884 0-90.325192-37.089733-95.468329-85.946464L160.192446 323.358619c-1.850138-17.575284 10.898211-33.32192 28.472471-35.172057 17.575284-1.850138 33.32192 10.898211 35.172058 28.473494l57.965179 550.672788c1.714038 16.285918 15.446807 28.64848 31.822776 28.648481h396.74707c16.375969 0 30.108738-12.363585 31.822776-28.648481l57.967226-550.673811z m-192.176904 99.345636c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-191.990662 0c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-31.998785-223.989447h255.987209v-47.998178c0-8.836249-7.163143-15.999392-15.999393-15.999392H399.995043c-8.836249 0-15.999392 7.163143-15.999392 15.999392v47.998178z m-63.996546 0V128.018675c0-35.344996 28.652574-63.996546 63.997569-63.996546h255.987209c35.343973 0 63.996546 28.652574 63.996546 63.996546v63.996547h223.99968c17.672498 0 31.998785 14.326287 31.998785 31.998785s-14.326287 31.998785-31.998785 31.998784H96.019891c-17.672498 0-31.998785-14.326287-31.998785-31.998784s14.326287-31.998785 31.998785-31.998785h223.979214z" p-id="690"></path></svg>',r.title="删除表格",r.onclick=c,e.appendChild(i),e.appendChild(r)}function a(e){return e?[e.rows.length,e.rows.item(0).cells.length]:[0,0]}function d(e){var t=e.target.parentNode.parentNode;if(t.nextSibling&&"TABLE"==t.nextSibling.nodeName){var o=e.target.nextSibling;if("none"==o.style.display){o.style.display="";var n=a(t.nextSibling);o.childNodes[0].value=n[0].toString(),o.childNodes[1].value=n[1].toString()}else!function(e,t){if(-1==t[0]||-1==t[1])return null;var o=a(e);if(t[0]!=o[0])if(t[0]<o[0])for(var n=o[0]-1;n>t[0]-1;n--)e.rows[n].parentNode.removeChild(e.rows[n]);else for(n=t[0]-o[0];n>0;n--){for(var i=document.createElement("tr"),r=0;r<o[1];r++){var s=document.createElement("td");i.appendChild(s)}e.childNodes[1].appendChild(i)}if(t[1]!=o[1])if(t[1]<o[1])for(n=o[1]-1;n>t[1]-1;n--)for(r=0;r<e.rows.length;r++)e.rows[r].cells[n].parentNode.removeChild(e.rows[r].cells[n]);else for(n=t[1]-o[1];n>0;n--)for(r=0;r<e.rows.length;r++)0==r?e.rows[r].appendChild(document.createElement("th")):e.rows[r].appendChild(document.createElement("td"))}(t.nextSibling,[parseInt(o.childNodes[0].value),parseInt(o.childNodes[1].value)]),o.style.display="none"}}function c(e){var t=e.target.parentNode.parentNode;t.nextSibling&&"TABLE"==t.nextSibling.nodeName&&(t.parentNode.removeChild(t.nextSibling),t.parentNode.removeChild(t))}function h(e){console.log(e)}function u(e,t){void 0===t&&(t=""),e.innerHTML="",e.setAttribute("style","width:100%;font-weight: 600;visibility:hidden;display:flex;font-size:13px;");var o=document.createElement("span");o.style.letterSpacing="4px",o.style.color="#aaa",o.style.position="relative",o.style.top="3px",o.innerHTML="```";var n=document.createElement("input");n.setAttribute("style","font-size:14px;letter-spacing:1px;font-weight: 600;padding: 1px 2px;border: none;outline: none;color: #1abc9c;display: flex;flex-direction: column;flex: 1 1 0%;"),n.title="设置代码语言",n.value=t,n.onchange=p,e.appendChild(o),e.appendChild(n)}function p(){this.parentNode.nextSibling.childNodes[0].className="lang-"+this.value}function f(e,t){var o=window.getSelection().toString();t.style.display="none",window.open("https://www.baidu.com/s?ie=UTF-8&wd="+o)}function m(e,t){return t.style.display="none",document.execCommand("Copy"),!0}function g(e,t){t.style.display="none",document.execCommand("Cut")}function N(e,t){t.style.display="none",document.execCommand("Paste")}function y(e,t){var o=document.createElement("script");o.type="text/javascript",void 0!==t&&(o.onload=function(){t()}),o.src=e,document.body.appendChild(o)}function v(e){var t=document.getElementsByTagName("head")[0],o=document.createElement("link");o.rel="stylesheet",o.type="text/css",o.href=e,t.appendChild(o)}function b(e){var t=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",o.appendChild(document.createTextNode(e)),t.appendChild(o)}function x(e,t){return(" "+e.className+" ").indexOf(" "+t+" ")>-1}function w(e){S(e,"**")}function T(e){S(e,"*")}function C(e){S(e,"~~")}function A(e){S(e,"__")}function E(e){S(e,"^")}function k(e){S(e,"~")}function S(e,t){var o,n=e.editor.cursor.getSelection();"#text"==n.focusNode.nodeName?(o=(o=n.focusNode.nodeValue).substring(0,n.focusOffset)+t+o.substring(n.focusOffset),n.focusNode.nodeValue=o):(o=(o=n.focusNode.innerText).substring(0,n.focusOffset)+t+o.substring(n.focusOffset),n.focusNode.innerText=o);"#text"==n.anchorNode.nodeName?(o=(o=n.anchorNode.nodeValue).substring(0,n.anchorOffset)+t+o.substring(n.anchorOffset),n.anchorNode.nodeValue=o):(o=(o=n.anchorNode.innerText).substring(0,n.anchorOffset)+t+o.substring(n.anchorOffset),n.anchorNode.innerText=o);e.editor.render(),n.focusInlineOffset+=2*t.length,n.anchorInlineOffset=n.focusInlineOffset,e.editor.cursor.setSelection(n)}function _(e){var t=document.createElement("div");function o(o,n,i){var r=document.createElement("span");r.setAttribute("class","art-floatToolbar-span"),r.innerText=o,r.title=n,r.onmousedown=function(o){return function(){o(e),t.style.display="none"}}(i),t.appendChild(r)}return t.style.width="180px",t.style.position="absolute",t.style.top="10px",t.style.left="10px",t.style.fontWeight="800",t.style.fontSize="17px",t.style.padding="3px 8px",t.style.boxShadow="0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04)",t.style.transition="all .15s cubic-bezier(0,0,.2,1)",t.style.border="1px solid #e6e6e6",t.style.display="none",o("B","粗体(ctrl+b)",w),o("I","斜体(crtl+i)",T),o("D","删除线(ctrl+shift+d)",C),o("S","下划线(ctrl+u)",A),o("u","上标(ctrl+alt+s)",E),o("d","下标(ctrl+shift+s)",k),t}function D(e,t,o){void 0===o&&(o="null");var n=document.createElement("div");n.style.position="fixed",n.style.boxShadow="0 2px 12px 0 rgba(0, 0, 0, 0.1)",n.style.borderRadius="4px",n.style.left="50%",n.style.margin="-27px 0 0 -170px",n.style.position="fixed !important",n.style.top="40px",n.style.height="40px",n.style.lineHeight="40px",n.style.width="340px",n.style.padding="1px 10px 1px 15px",n.style.transition="opacity .3s,transform .4s,top .4s,-webkit-transform .4s",n.style.zIndex="1000",n.style.overflow="hidden";var i=document.createElement("p");return i.innerHTML=t,i.style.fontSize="13px",i.style.fontWeight="600",i.style.height="100%",i.style.margin="0",n.appendChild(i),"info"==o?(n.style.backgroundColor="#edf2fc",n.style.borderColor="#EBEEF5",n.style.color="#909399"):"success"==o?(n.style.backgroundColor="#f0f9eb",n.style.borderColor="#e1f3d8",n.style.color="#67C23A"):"warning"==o?(n.style.backgroundColor="#fdf6ec",n.style.borderColor="#faecd8",n.style.color="#E6A23C"):"error"==o?(n.style.backgroundColor="#fef0f0",n.style.backgroundColor="#fde2e2",n.style.borderColor="#e1f3d8",n.style.color="#F56C6C"):(n.style.backgroundColor=e.options.theme.backgroundColor,n.style.color="#676767"),setTimeout((function(){e.rootDom.removeChild(n)}),3e3),e.rootDom.appendChild(n),n}var L=function(){function e(e){this.artText=e,this.root=document.createElement("div"),this.root.style.position="fixed",this.root.style.zIndex="10",this.root.style.width="60vw",this.root.style.right="20vw",this.root.style.height="92vh",this.root.style.top="4vh",this.root.style.backgroundColor="#fff",this.root.style.boxShadow="0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04)",this.root.style.borderRadius="2px",this.root.style.zIndex="5",this.root.style.display="none",this.maskLayer=document.createElement("div"),this.maskLayer.style.position="fixed",this.maskLayer.style.top="0",this.maskLayer.style.right="0",this.maskLayer.style.bottom="0",this.maskLayer.style.left="0",this.maskLayer.style.background="rgba(26,26,26,.65)",this.maskLayer.style.zIndex="1",this.maskLayer.style.display="none";var t,o=document.createElement("span");o.style.position="absolute",o.style.right="-60px",o.style.padding="12px",o.style.cursor="pointer",o.style.color="#fff",o.innerHTML='<svg class="icon" style="width: 30px; height: 30px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1187"><path d="M557.252647 512l135.75794 135.75794c12.495592 12.495592 12.495592 32.757055 0 45.252647-12.495592 12.495592-32.757055 12.495592-45.252647 0L512 557.252647 376.24206 693.010587c-12.496615 12.496615-32.757055 12.495592-45.252647 0-12.495592-12.495592-12.496615-32.756031 0-45.252647l135.75794-135.75794L330.989413 376.24206c-12.496615-12.496615-12.495592-32.757055 0-45.252647 12.495592-12.495592 32.756031-12.496615 45.252647 0l135.75794 135.75794 135.75794-135.75794c12.495592-12.495592 32.756031-12.495592 45.252647 0 12.495592 12.495592 12.495592 32.757055 0 45.252647L557.252647 512z m-429.233972 0c0 212.062813 171.918511 383.981325 383.981325 383.981325s383.981325-171.918511 383.981325-383.981325S724.06179 128.018675 512 128.018675 128.018675 299.937187 128.018675 512z m-63.997569 0c0-247.406786 200.572108-447.978894 447.978894-447.978894S959.977871 264.593214 959.977871 512 759.405763 959.977871 512 959.977871 64.021106 759.405763 64.021106 512z" p-id="1188"></path></svg>',o.onclick=(t=this,function(){t.close()});var n=document.createElement("div");n.style.display="flex",n.style.width="210px",n.style.flexDirection="column",n.style.borderRight="1px solid #ebebeb";var i=document.createElement("div");i.style.padding="12px 20px",i.style.fontWeight="600",i.style.display="flex",i.innerHTML="历史版本";var r=document.createElement("div");r.style.display="flex",r.style.flexDirection="column",r.style.justifyContent="center",r.style.overflow="auto",this.sideDraftHistoryDirectory=document.createElement("div"),r.appendChild(this.sideDraftHistoryDirectory),this.sideDraftHistoryDirectory.style.overflow="auto",null!=localStorage.art_articles?this.art_articles=JSON.parse(localStorage.art_articles):(this.art_articles={},localStorage.art_articles=JSON.stringify(this.art_articles)),n.appendChild(i),n.appendChild(r);var s=document.createElement("div");s.style.flex="1 1",s.style.display="flex",s.style.flexDirection="column",s.style.overflow="auto",this.mainArticle=document.createElement("div"),this.mainArticle.style.flex="1 1",this.mainArticle.style.display="flex",this.mainArticle.style.overflow="auto",this.mainArticle.innerHTML='<textarea style="width: 100%;border: none;resize: none;outline: none;padding:13px 15px;font-size: 15px" readonly>无打开</textarea>',this.mainFooter=document.createElement("div"),this.mainFooter.style.height="52px",this.mainFooter.style.display="flex",this.mainFooter.style.borderTop="1px solid #ebebeb",this.mainFooter.style.alignItems="center",this.mainFooter.style.padding="0 20px",this.footerDel=document.createElement("button"),this.footerDel.setAttribute("style","border-radius: 18px;margin-right: 20px;color:#e01a1a;border:none;padding: 3px 8px 6px;font-size: 13px;font-weight: 600;background: rgba(239, 26, 26, 0.08);cursor: pointer;"),this.footerDel.innerHTML='<svg class="icon" style="width: 17px; height: 17px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="689"><path d="M800.162002 316.659033c1.850138-17.575284 17.596773-30.322609 35.172058-28.473495 17.575284 1.850138 30.322609 17.596773 28.473494 35.172058l-57.966202 550.673811c-5.143137 48.856731-46.341445 85.946464-95.467306 85.946464H313.625954c-49.126884 0-90.325192-37.089733-95.468329-85.946464L160.192446 323.358619c-1.850138-17.575284 10.898211-33.32192 28.472471-35.172057 17.575284-1.850138 33.32192 10.898211 35.172058 28.473494l57.965179 550.672788c1.714038 16.285918 15.446807 28.64848 31.822776 28.648481h396.74707c16.375969 0 30.108738-12.363585 31.822776-28.648481l57.967226-550.673811z m-192.176904 99.345636c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-191.990662 0c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-31.998785-223.989447h255.987209v-47.998178c0-8.836249-7.163143-15.999392-15.999393-15.999392H399.995043c-8.836249 0-15.999392 7.163143-15.999392 15.999392v47.998178z m-63.996546 0V128.018675c0-35.344996 28.652574-63.996546 63.997569-63.996546h255.987209c35.343973 0 63.996546 28.652574 63.996546 63.996546v63.996547h223.99968c17.672498 0 31.998785 14.326287 31.998785 31.998785s-14.326287 31.998785-31.998785 31.998784H96.019891c-17.672498 0-31.998785-14.326287-31.998785-31.998784s14.326287-31.998785 31.998785-31.998785h223.979214z" p-id="690"></path></svg>',this.footerTag=document.createElement("button"),this.footerTag.setAttribute("style","border-radius: 18px;margin-right: 20px;color:#ebeb18;border:none;padding: 3px 8px 6px;font-size: 13px;font-weight: 600;background: rgba(229, 229, 109, 0.1);cursor: pointer;"),this.footerTag.innerHTML='<svg class="icon" style="width: 18px; height: 18px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2298"><path d="M512 64.021106c-11.816117 0-23.63121 6.791683-28.127617 20.375049l-97.82705 295.566646H93.719498c-27.710109 0-40.267099 34.785248-18.987446 52.612265L304.048831 624.711038l-82.039481 297.444413c-5.655813 20.513196 10.561543 37.82242 28.662806 37.82242 5.698792 0 11.585873-1.717108 17.030885-5.588275l244.296959-173.672458L756.301052 954.389596c5.445012 3.873214 11.335163 5.588275 17.030885 5.588275 18.10024 0 34.31862-17.310248 28.65462-37.82242L719.951169 624.712061l229.316779-192.135972c21.280676-17.827017 8.725732-52.612265-18.991539-52.612264H637.954667L540.127617 84.396155c-4.496407-13.583366-16.311501-20.37505-28.127617-20.375049z" p-id="2299"></path></svg>',this.footerRestore=document.createElement("button"),this.footerRestore.setAttribute("style","border-radius: 6px;flex: 1 1;color:#1aba9c;border:none;padding: 3px 15px;font-size: 13px;font-weight: 600;background: rgba(26, 186, 156, 0.08);cursor: pointer;"),this.footerRestore.innerHTML="恢复",this.mainFooter.appendChild(this.footerDel),this.mainFooter.appendChild(this.footerTag),this.mainFooter.appendChild(this.footerRestore),s.appendChild(this.mainArticle),s.appendChild(this.mainFooter),this.root.appendChild(o),this.root.appendChild(n),this.root.appendChild(s),e.rootDom.appendChild(this.root),e.rootDom.appendChild(this.maskLayer)}return e.prototype.open=function(){this.root.style.display="flex",this.maskLayer.style.display="inline",this.art_articles=JSON.parse(localStorage.art_articles),document.body.style.overflow="hidden",this.updateDirectory()},e.prototype.updateDirectory=function(){this.sideDraftHistoryDirectory.innerHTML="";for(var e=0,t=Object.keys(this.art_articles).reverse();e<t.length;e++){var o=t[e],n=document.createElement("div");n.style.height="60px",n.style.padding="10px 20px 0",n.style.cursor="pointer";var i=new Date(1*parseInt(this.art_articles[o].time)).toLocaleString().replace(/\//g,"-").substring(0,16);n.innerHTML='<div style="font-weight: 500;">'+i+'</div><div style="font-size: 12px;">当前草稿</div>',n.onclick=this.openMd(this,this.art_articles[o]),this.sideDraftHistoryDirectory.appendChild(n)}this.mainArticle.childNodes[0].innerHTML="",this.mainFooter.style.display="none"},e.prototype.openMd=function(e,t){var o=localStorage[t.ids[0]];return function(){for(var n=e.sideDraftHistoryDirectory.getElementsByClassName("art-VersionHistory-selected"),i=n.length-1;i>=0;i--){var r=n[i].getAttribute("class");r=r.replace("art-VersionHistory-selected",""),n[i].setAttribute("class",r)}this.setAttribute("class","art-VersionHistory-selected"),e.mainArticle.childNodes[0].innerHTML=o,e.mainFooter.style.display="inherit",e.footerDel.onclick=function(){localStorage.removeItem(t.ids[0]),delete e.art_articles[t.name],e.updateDirectory(),H.message(t.name+"已删除","success")},e.footerRestore.onclick=function(){e.artText.editor.openFile(o,t.name),H.message(t.name+"已恢复","success"),e.close()}}},e.prototype.close=function(){localStorage.art_articles=JSON.stringify(this.art_articles),this.maskLayer.style.display="none",this.root.style.display="none",document.body.style.overflow="auto"},e}(),M=function(){function e(t){this.artText=t,this.versionHistory=new L(t),this.toolbar=null,this.floatAuxiliaryTool=null,this.floatToolbar=null,this.mdHtml=null,e.message=function(e,o){void 0===o&&(o="null"),D(t,e,o)}}return e.prototype.init=function(){var t,o;this.rooDom=this.artText.rootDom,this.toolbar=(t=this.artText.options.theme,(o=document.createElement("div")).style.marginBottom="25px",o.style.padding="10px 12px",o.style.boxShadow="0 2px 12px 0 rgba(0, 0, 0, 0.1)",o.style.backgroundColor=t.backgroundColor,o.setAttribute("class","art-toolbar"),H.addCss(".art-toolbar{color: #666; font-weight:600; font-size:13.5px; border-radius: 4px; position: relative;}"),o),this.rooDom.insertBefore(this.toolbar,this.rooDom.childNodes[0]),this.floatAuxiliaryTool=function(){var e=document.createElement("div");e.style.width="200px",e.style.position="absolute",e.style.top="10px",e.style.left="10px",e.style.boxShadow="0 2px 12px 0 rgba(0, 0, 0, 0.1)",e.style.transition="all .15s cubic-bezier(0,0,.2,1)",e.style.border="1px solid #d1d1d1",e.style.borderRadius="2px",e.style.display="none";var t=document.createElement("ul");t.setAttribute("style","list-style:none;margin:0;padding:4px 0;font-size: 13px;font-weight: 500;");var o=document.createElement("li");o.setAttribute("class","art-floatAuxiliaryTool-li"),o.setAttribute("style","padding: 3px 20px;margin:3px 0; cursor: pointer;"),o.innerHTML="使用百度搜索",o.onmousedown=i(f),t.appendChild(o);var n=document.createElement("hr");function i(t){return function(o){t(o,e)}}return n.style.height="0",n.style.marginBottom="0",t.appendChild(n),(o=document.createElement("li")).setAttribute("class","art-floatAuxiliaryTool-li"),o.setAttribute("style","padding: 3px 20px;margin:3px 0; cursor: pointer;"),o.innerText="剪切",o.onmousedown=i(g),t.appendChild(o),(o=document.createElement("li")).setAttribute("class","art-floatAuxiliaryTool-li"),o.setAttribute("style","padding: 3px 20px;margin:3px 0; cursor: pointer;"),o.innerText="复制",o.onmousedown=i(m),t.appendChild(o),(o=document.createElement("li")).setAttribute("class","art-floatAuxiliaryTool-li"),o.setAttribute("style","padding: 3px 20px;margin:3px 0; cursor: pointer;"),o.innerText="粘贴",o.onmousedown=i(N),t.appendChild(o),e.appendChild(t),e}(),this.floatAuxiliaryTool.style.backgroundColor=this.artText.options.theme.backgroundColor;var n=".art-floatAuxiliaryTool-li:hover{background-color: #f0f0f0;color:"+this.artText.options.theme.color+"}";this.rooDom.appendChild(this.floatAuxiliaryTool),this.floatToolbar=_(this.artText),this.floatToolbar.style.backgroundColor=this.artText.options.theme.backgroundColor;var i=".art-floatToolbar-span{padding: 8px 10px;cursor: pointer;}.art-floatToolbar-span:hover{color:"+this.artText.options.theme.color+"}";this.rooDom.appendChild(this.floatToolbar),this.addDefaultTool();e.addCss(O+".art-toolbar-span{padding:5px 5px;margin-right: 9px} .art-toolbar-span:hover{color:#1abc9c;}"+i+n)},e.prototype.setFloatAuxiliaryTool=function(e){if("hide"==e)return this.floatAuxiliaryTool.style.display="none",!1;this.floatAuxiliaryTool.style.display="inline",this.floatAuxiliaryTool.style.top=event.pageY.toString()+"px",this.floatAuxiliaryTool.style.left=event.pageX.toString()+"px"},e.prototype.setFloatToolbar=function(e){if("hide"==e)return this.floatToolbar.style.display="none",!1;this.floatToolbar.style.display="inline";var t=event.pageX-this.artText.eventCenter.clickInfo.pageX,o=event.pageY-this.artText.eventCenter.clickInfo.pageY;if(console.log(t,o),o>0){var n=this.artText.eventCenter.clickInfo;this.floatToolbar.style.top=(n.pageY-n.offsetY-20).toString()+"px",this.floatToolbar.style.left=(n.pageX+t/2).toString()+"px"}else this.floatToolbar.style.top=(event.pageY-event.offsetY-20).toString()+"px",this.floatToolbar.style.left=(event.pageX+t/2).toString()+"px"},e.prototype.addDefaultTool=function(){var t=this;this.mdHtml=this.addTool("md",(function(){"md"==t.mdHtml.innerHTML?(t.mdHtml.innerHTML="html",t.artText.editor.openTextarea()):(t.mdHtml.innerHTML="md",t.artText.editor.closeTextarea())})),this.addTool("历史",(function(){t.versionHistory.open()})),this.addTool("保存",(function(){var o=JSON.parse(localStorage.art_articles);if(t.artText.editor.fileInfo.name&&o.hasOwnProperty(t.artText.editor.fileInfo.name))e.message("逻辑无"),D(t.artText,"路基");else{var n=(new Date).getTime(),i="art_md_"+n+"_";t.artText.editor.fileInfo.name&&(i+=t.artText.editor.fileInfo.name),localStorage[i]=t.artText.editor.getMd(),o[i]={ids:[i],time:n,name:i},localStorage.art_articles=JSON.stringify(o),D(t.artText,"md保存成功","success")}})),this.addTool("清空",(function(){t.artText.editor.emptyEditor(),D(t.artText,"清空成功","success")})),this.addTool('<span style="position: absolute;right: 12px;color:#1abc9c" >ATTB</span>',(function(){D(t.artText,"点击了一下")}),!1)},e.prototype.addTool=function(e,t,o){void 0===o&&(o=!0);var n=document.createElement("span");return o&&n.setAttribute("class","art-toolbar-span"),n.style.cursor="pointer",n.innerHTML=e,n.addEventListener("click",t),this.toolbar.appendChild(n),n},e.loadScript=y,e.loadCss=v,e.addCss=b,e.hasClass=x,e.message=null,e}(),O=".art-VersionHistory-selected{color: #1aba9c}\n.art-toc{padding: 6px 15px;margin: 0 0 15px;font-weight:500;border: 1px dashed #9990;}.art-toc p{margin-bottom: 2px}.art-toc a{border-bottom: none;color: #4183c4}.art-toc-h2{margin-left:2em}.art-toc-h3{margin-left:4em}.art-toc-h4{margin-left:6em}.art-toc-h5{margin-left:8em}.art-toc-h6{margin-left:10em}\n.art-flowTool{width:100%;text-align: center;}",H=M;function j(e){e.innerHTML="",e.style.width="100%",e.style.fontSize="14px",e.style.position="relative",e.style.visibility="hidden";var t=document.createElement("span");t.style.fontWeight="600",t.innerHTML="目录";var o=document.createElement("span");o.innerHTML='<svg class="icon" style="width: 18px; height: 18px;color: red;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="689"><path d="M800.162002 316.659033c1.850138-17.575284 17.596773-30.322609 35.172058-28.473495 17.575284 1.850138 30.322609 17.596773 28.473494 35.172058l-57.966202 550.673811c-5.143137 48.856731-46.341445 85.946464-95.467306 85.946464H313.625954c-49.126884 0-90.325192-37.089733-95.468329-85.946464L160.192446 323.358619c-1.850138-17.575284 10.898211-33.32192 28.472471-35.172057 17.575284-1.850138 33.32192 10.898211 35.172058 28.473494l57.965179 550.672788c1.714038 16.285918 15.446807 28.64848 31.822776 28.648481h396.74707c16.375969 0 30.108738-12.363585 31.822776-28.648481l57.967226-550.673811z m-192.176904 99.345636c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-191.990662 0c17.672498 0 31.998785 14.326287 31.998785 31.998785v223.989447c0 17.672498-14.326287 31.998785-31.998785 31.998785s-31.998785-14.326287-31.998785-31.998785V448.00243c0-17.671475 14.326287-31.997762 31.998785-31.997761z m-31.998785-223.989447h255.987209v-47.998178c0-8.836249-7.163143-15.999392-15.999393-15.999392H399.995043c-8.836249 0-15.999392 7.163143-15.999392 15.999392v47.998178z m-63.996546 0V128.018675c0-35.344996 28.652574-63.996546 63.997569-63.996546h255.987209c35.343973 0 63.996546 28.652574 63.996546 63.996546v63.996547h223.99968c17.672498 0 31.998785 14.326287 31.998785 31.998785s-14.326287 31.998785-31.998785 31.998784H96.019891c-17.672498 0-31.998785-14.326287-31.998785-31.998784s14.326287-31.998785 31.998785-31.998785h223.979214z" p-id="690"></path></svg>',o.title="删除目录",o.style.position="absolute",o.style.right="0",o.style.cursor="pointer",o.onclick=z,e.appendChild(t),e.appendChild(o)}function z(e){var t=e.target.parentNode.parentNode;t.nextSibling&&H.hasClass(t.nextSibling,"art-toc")&&(t.parentNode.removeChild(t.nextSibling),t.parentNode.removeChild(t))}var R=function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),I=function(e){function t(t,o,n){void 0===o&&(o={}),void 0===n&&(n=null);var i=e.call(this,t)||this;i.parentNode=null,i.attr=o,i.childNodes=n instanceof Array?n:null==n?[]:[n];for(var r=0,s=i.childNodes;r<s.length;r++){s[r].parentNode=i}return i}return R(t,e),t.prototype.newDom=function(){var e,t=this;for(var o in this.dom=document.createElement(this.nodeName),this.attr)"__dom__"===o?"tableTool"===this.attr[o]?l(this.dom):"imgTool"===this.attr[o]?this.dom.appendChild((e=void 0,(e=document.createElement("span")).style.fontSize="14px",e.setAttribute("contenteditable","false"),e.innerHTML='<svg class="icon" style="width: 19px; height: 19px;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1140"><path d="M288.010553 448.00243c-35.344996 0-63.996546-28.652574-63.996546-63.996546s28.652574-63.996546 63.996546-63.996546c35.344996 0 63.996546 28.652574 63.996546 63.996546s-28.65155 63.996546-63.996546 63.996546z m639.969556 302.169018l-258.988565-258.077823L372.528482 759.740384c-12.629645 11.402701-31.975249 10.92584-44.027749-1.084705L220.383316 650.927119l-124.363425 100.357686v80.699973c0 17.672498 14.326287 31.998785 31.998784 31.998785h767.96265c17.672498 0 31.998785-14.326287 31.998784-31.998785v-81.81333z m0-90.346681V192.015222c0-17.672498-14.326287-31.998785-31.998784-31.998785H128.018675c-17.672498 0-31.998785 14.326287-31.998784 31.998785v477.033627l84.173074-67.926042c25.424042-20.516266 62.219063-18.58938 85.361133 4.469801l86.61673 86.306668 273.934976-247.308549c25.261337-22.805402 63.951521-21.851681 88.058569 2.170433l213.815736 213.063607zM32.023344 736.273926a45.762253 45.762253 0 0 1 0-0.530072V192.015222c0-53.016471 42.97886-95.995331 95.995331-95.995331h767.96265c53.016471 0 95.995331 42.97886 95.995331 95.995331v639.969556c0 53.016471-42.97886 95.995331-95.995331 95.995331H128.018675c-53.016471 0-95.995331-42.97886-95.995331-95.995331v-95.710852z" p-id="1141"></path></svg>',e.style.cursor="pointer",e.onclick=h,e)):"codeTool"===this.attr[o]?u(this.dom,this.attr.__dict__.codeLang):"tocTool"==this.attr[o]&&j(this.dom):"art-math"==o?ie.plugins.katex?(this.dom.innerHTML=ie.plugins.katex.renderToString(this.attr["art-math"],{throwOnError:!1}),this.dom.setAttribute(o,this.attr[o])):this.dom.setAttribute(o,"\n@math:katex未加载出@\n"):/^__[a-zA-Z\d]+__$/.test(o)||this.dom.setAttribute(o,this.attr[o]);return this.childNodes.forEach((function(e){t.dom.appendChild(e.newDom())})),this.dom},t.prototype.appendChild=function(e){return this.childNodes.push(e),e.parentNode=this,!0},t.prototype.replaceChild=function(e,t){var o=this.childNodes.indexOf(t);return-1!=o&&(e.parentNode=this,this.childNodes[o]=e,!0)},t.prototype.replaceAllChild=function(e){if(e){this.childNodes=[];for(var t=0,o=e;t<o.length;t++){var n=o[t];this.appendChild(n)}return!0}return!1},t.prototype.insertBefore=function(e,t){var o=this.childNodes.indexOf(t);return-1!=o&&(e.parentNode=this,this.childNodes.splice(o,0,e),!0)},t.prototype.insertAfter=function(e,t){var o=this.childNodes.indexOf(t);return-1!=o&&(e.parentNode=this,this.childNodes.splice(o+1,0,e),!0)},t.prototype.removeChild=function(e){var t=this.childNodes.indexOf(e);return-1!=t&&(this.childNodes.splice(t,1),!0)},t.prototype.hasClass=function(e){return!!this.attr.class&&(" "+this.attr.class+" ").indexOf(" "+e+" ")>-1},t.prototype.getMd=function(e){void 0===e&&(e="editor");var t="";if(/art-toc(\s|$)/.test(this.attr.class))return"[TOC]\n";if("a"==this.nodeName&&this.childNodes.length>0)t+=this.childNodes[0].text;else{if(this.attr.class&&/art-shield/.test(this.attr.class))return"";if("read"==e)if("hr"==this.nodeName)t+="***\n";else if("input"==this.nodeName&&"checkbox"==this.attr.type)"checked"==this.attr.checked?t+="[x] ":t+="[ ] ";else if("blockquote"==this.nodeName)for(var o=0;o<this.childNodes.length;o++)for(var n=0,i=l=this.childNodes[o].getMd(e).replace(/\s$/,"").split("\n");n<i.length;n++){t+="> "+i[n]+"\n"}else if("ul"==this.nodeName)for(o=0;o<this.childNodes.length;o++)for(var r=0,s=l=this.childNodes[o].getMd(e).replace(/\s$/,"").split("\n");r<s.length;r++){t+="* "+s[r]+"\n"}else if("ol"==this.nodeName)for(o=0;o<this.childNodes.length;o++)for(var l,a=0,d=(l=this.childNodes[o].getMd(e).replace(/\s$/,"").split("\n")).length;a<d;a++)t+=0==a?(o+1).toString()+". "+l[a]+"\n":"   "+l[a]+"\n";else if("li"==this.nodeName)for(o=0;o<this.childNodes.length;o++)t+=this.childNodes[o].getMd(e);else if("h1 h2 h3 h4 h5 h6".indexOf(this.nodeName)>=0||"p"==this.nodeName){for(o=0;o<this.childNodes.length;o++)t+=this.childNodes[o].getMd(e);t+="\n"}else if("table"==this.nodeName)for(var c=0;c<this.childNodes.length;c++)for(o=0;o<this.childNodes[c].childNodes.length;o++){t+="|";a=void 0;for(a=0;a<this.childNodes[c].childNodes[o].childNodes.length;a++)t+=this.childNodes[c].childNodes[o].childNodes[a].getMd(e)+"|";if(t+="\n",0==c){for(t+="|";a--;)t+="---|";t+="\n"}}else if("pre"==this.nodeName){t+="```";var h=this.childNodes[0].attr.class;if(h){var u=h.match(/lang-(.*?)(\s|$)/);u&&(t+=u[1])}t+="\n";for(o=0;o<this.childNodes.length;o++)t+=this.childNodes[o].getMd(e);t+="```\n"}else for(o=0;o<this.childNodes.length;o++)t+=this.childNodes[o].getMd(e);else for(o=0;o<this.childNodes.length;o++)t+=this.childNodes[o].getMd(e)}return t},t.prototype.getText=function(){for(var e="",t=0,o=this.childNodes;t<o.length;t++){var n=o[t];"#text"==n.nodeName?e+=n.getText():null==n.attr.class||/(art\-shield)|(art\-hide)|(art\-show)/.test(n.attr.class)||(e+=n.getText())}return e},t}(i);function B(e){if(""===e)return[new I("br")];for(var t,o,n=[];e;){o=null;for(var i=0;i<$.length;i++)if(t=e.match($[i].re)){if(0==t.index){o=[t,$[i]];break}o?o[0].index>t.index&&(o=[t,$[i]]):o=[t,$[i]]}if(!o){n.push(new s(e));break}0!=o[0].index&&n.push(new s(e.substring(0,o[0].index))),o[1].fun(o[0][0]).forEach((function(e){n.push(e)})),e=e.substring(o[0].index+o[0][0].length)}return n}var $=[{tag:"bi",left:"***",right:"***",re:/(\*{3})([^\*].*?)(\*{3})/,fun:function(e){var t=new I("span",{class:"art-hide"},new s("***")),o=new I("span",{class:"art-text-double"},new s(e.substring(3,e.length-3))),n=new I("span",{class:"art-hide"},new s("***"));return[new I("i",{},new I("b",{},[t,o,n]))]}},{tag:"b",left:"**",right:"**",re:/(\*{2})([^\*].*?)(\*{2})/,fun:function(e){return F(["**",2,e,"**","b"])}},{tag:"mark",left:"==",right:"==",re:/\={2}[^\=].*?\={2}/,fun:function(e){return F(["==",2,e,"==","mark"])}},{tag:"code",left:"`",right:"`",re:/`[^`]+`/,fun:function(e){return F(["`",1,e,"`","code"])}},{tag:"i",left:"*",right:"*",re:/(\*)([^\*].*?)(\*)/,fun:function(e){return F(["*",1,e,"*","i"])}},{tag:"img",left:"![",centre:"](",right:")",re:/!\[.*?\]\(.*?\)/,fun:function(e){var t=e.match(/\(.*\)/)[0],o=e.match(/\[.*\]/)[0],n=new I("span",{class:"art-hide"},[new I("span",{class:"art-shield",__dom__:"imgTool"},[]),new s(e)]),i=new I("img",{src:t.substring(1,t.length-1),alt:o.substring(1,o.length-1),contenteditable:"false",style:"margin: 0 auto;display: block;"},null);return[n,i]}},{tag:"a",left:"[",centre:"](",right:")",re:/\[.*?\]\(.*?\)/,fun:function(e){var t=e.match(/\(.*\)/)[0],o=e.match(/\[.*\]/)[0],n=new I("span",{class:"art-hide"},new s("[")),i=new I("a",{href:t.substring(1,t.length-1),class:"art-text-double",title:"alt+点击",style:"cursor: pointer;"},new s(o.substring(1,o.length-1))),r=new I("span",{class:"art-hide"},new s("]"+t));return[n,i,r]}},{tag:"math",left:"$",right:"$",re:/\$.*?\$/,fun:function(e){if(ie.plugins.katex){var t=new I("span",{class:"art-hide art-math"},new s(e));return[new I("span",{class:"art-shield",style:"position: relative;",contenteditable:"false",__dom__:"math"},new I("span",{style:"top: 35px;display: inline-table;","art-math":e.substring(1,e.length-1)},null)),t]}return[new I("span",{style:"color: #777"},new s(e))]}},{tag:"del",left:"~~",right:"~~",re:/~{2}.*?~{2}/,fun:function(e){return F(["~~",2,e,"~~","del"])}},{tag:"ins",left:"__",right:"__",re:/_{2}.*?_{2}/,fun:function(e){return F(["__",2,e,"__","ins"])}},{tag:"sup",left:"^",right:"^",re:/\^[^\^]+\^/,fun:function(e){return P(["^",1,e,"^","sup"])}},{tag:"sub",left:"~",right:"~",re:/~[^~]+~/,fun:function(e){return P(["~",1,e,"~","sub"])}},{tag:"html_tag",left:"null",right:"null",re:/(<!--[\s\S]*?-->|(<([a-zA-Z]{1}[a-zA-Z\d-]*) *[^\n<>]* *(?:\/)?>)(?:([\s\S]*?)(<\/\3 *>))?)/,fun:function(e){var t=/\s([a-z]+)="(.*?)"/,o=e.match(/^<([a-zA-Z]+)( .*?)?>([\s\S]*?)<\/\1+>/);if(null==o)return[new s(e)];var n={class:"art-text-double"};if(o[2])for(var i=o[2].match(/\s([a-z]+)="(.*?)"/g),r=0;r<i.length;r++){var l=i[r].match(t);n[l[1]]=l[2]}"art-text-double"!=n.class&&(n.class+=" art-text-double");null==o[2]&&(o[2]="");var a=new I("span",{class:"art-hide"},new s("<"+o[1]+o[2]+">")),d=new I(o[1],n,B(o[3])),c=new I("span",{class:"art-hide"},new s("</"+o[1]+">"));return[a,d,c]}}];function F(e){return[new I("span",{class:"art-hide"},new s(e[0])),new I(e[4],{class:"art-text-double"},B(e[2].substring(e[1],e[2].length-e[1]))),new I("span",{class:"art-hide"},new s(e[3]))]}function P(e){var t=new I("span",{class:"art-hide"},new s(e[0])),o=new I("span",{class:"art-text-double"},B(e[2].substring(e[1],e[2].length-e[1]))),n=new I("span",{class:"art-hide"},new s(e[3]));return[new I(e[4],{},[t,o,n])]}var V=B,K=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<o;t++)for(var r=arguments[t],s=0,l=r.length;s<l;s++,i++)n[i]=r[s];return n};var q=[{first:"#",last:"",re:/^#\s/,fun:function(e){var t=K([new I("span",{class:"art-hide"},new s("# "))],V(e.substring(2))),o=new I("h1",{},t),n=o.getMd();return n=n.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),o.childNodes.unshift(new I("a",{class:"art-shield",name:n},null)),[o]}},{first:"##",last:"",re:/^##\s/,fun:function(e){var t=K([new I("span",{class:"art-hide"},new s("## "))],V(e.substring(3))),o=new I("h2",{},t),n=o.getMd();return n=n.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),o.childNodes.unshift(new I("a",{class:"art-shield",name:n},null)),[o]}},{first:"###",last:"",re:/^###\s/,fun:function(e){var t=K([new I("span",{class:"art-hide"},new s("### "))],V(e.substring(4))),o=new I("h3",{},t),n=o.getMd();return n=n.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),o.childNodes.unshift(new I("a",{class:"art-shield",name:n},null)),[o]}},{first:"####",last:"",re:/^####\s/,fun:function(e){var t=K([new I("span",{class:"art-hide"},new s("#### "))],V(e.substring(5))),o=new I("h4",{},t),n=o.getMd();return n=n.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),o.childNodes.unshift(new I("a",{class:"art-shield",name:n},null)),[o]}},{first:"#####",last:"",re:/^#####\s/,fun:function(e){var t=K([new I("span",{class:"art-hide"},new s("##### "))],V(e.substring(6))),o=new I("h5",{},t),n=o.getMd();return n=n.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),o.childNodes.unshift(new I("a",{class:"art-shield",name:n},null)),[o]}},{first:"######",last:"",re:/^######\s/,fun:function(e){var t=K([new I("span",{class:"art-hide"},new s("###### "))],V(e.substring(7))),o=new I("h6",{},t),n=o.getMd();return n=n.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,""),o.childNodes.unshift(new I("a",{class:"art-shield",name:n},null)),[o]}}];var X=function(e){if(""===e)return[new I("p",{},new I("br"))];for(var t=0;t<q.length;t++)if(e.match(q[t].re))return q[t].fun(e);return null},Y=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<o;t++)for(var r=arguments[t],s=0,l=r.length;s<l;s++,i++)n[i]=r[s];return n};function U(e,t){var o=2;return"ol"==t&&(o=3),""==e.substring(o)?new I("li",{},new I("br")):"ul"==t&&/^\[x|X\]\s/.test(e.substring(2))?new I("li",{style:"list-style:none"},Y([new I("input",{type:"checkbox",checked:"checked",style:"position: relative;left: -5px;"})],V(e.substring(6)))):"ul"==t&&/^\[\s\]\s/.test(e.substring(2))?new I("li",{style:"list-style:none"},Y([new I("input",{type:"checkbox",style:"position: relative;left: -5px;"})],V(e.substring(6)))):/^\*\s/.test(e.substring(o))?new I("li",{},new I("ul",{},U(e.substring(o),"ul"))):/^\d\.\s/.test(e.substring(o))?new I("li",{},new I("ol",{},U(e.substring(o),"ol"))):/^>\s/.test(e.substring(2))?new I("li",{},new I("blockquote",{},Z(e.substring(2)))):new I("li",{},V(e.substring(o)))}function Z(e){return""==e.substring(2)?new I("p",{},new I("br")):/^>\s/.test(e.substring(2))?new I("blockquote",{},Z(e.substring(2))):/^\*\s/.test(e.substring(2))?new I("ul",{},U(e.substring(2),"ul")):/^\d\.\s/.test(e.substring(2))?new I("ol",{},U(e.substring(2),"ol")):new I("p",{},V(e.substring(2)))}function J(e){for(var t=e.childNodes,o=[],n=0;n<t.length;n++)"blockquote"==t[n].nodeName&&o.length>0&&"blockquote"==o[o.length-1].nodeName||"ul"==t[n].nodeName&&o.length>0&&"ul"==o[o.length-1].nodeName||"ol"==t[n].nodeName&&o.length>0&&"ol"==o[o.length-1].nodeName?o[o.length-1].childNodes.push(t[n].childNodes[0]):"ul"==t[n].childNodes[0].nodeName&&o.length>0&&"ul"==o[o.length-1].childNodes[0].nodeName||"ol"==t[n].childNodes[0].nodeName&&o.length>0&&"ol"==o[o.length-1].childNodes[0].nodeName?o[o.length-1].childNodes[0].childNodes.push(t[n].childNodes[0].childNodes[0]):(o.length>0&&("blockquote"==o[o.length-1].nodeName?o[o.length-1]=J(o[o.length-1]):"ul ol".indexOf(o[o.length-1].childNodes[0].nodeName)>=0?o[o.length-1].childNodes[0]=J(o[o.length-1].childNodes[0]):"ul ol".indexOf(o[o.length-1].nodeName)>=0&&(o[o.length-1]=J(o[o.length-1]))),o.push(t[n]));return o.length>0&&("blockquote"==o[o.length-1].nodeName?o[o.length-1]=J(o[o.length-1]):"ul ol".indexOf(o[o.length-1].childNodes[0].nodeName)>=0?o[o.length-1].childNodes[0]=J(o[o.length-1].childNodes[0]):"ul ol".indexOf(o[o.length-1].nodeName)>=0&&(o[o.length-1]=J(o[o.length-1]))),e.childNodes=o,e}function W(e){if("#text"==e.nodeName)return new s(e.nodeValue);for(var t=new I(e.nodeName.toLowerCase(),{},[]),o=0;o<e.attributes.length;o++){var n=e.attributes[o];t.attr[n.localName]=n.value}"INPUT"==e.nodeName&&(e.checked?t.attr.checked="checked":t.attr.checked&&delete t.attr.checked);for(o=0;o<e.childNodes.length;o++)t.appendChild(W(e.childNodes[o]));return t}var Q=function(e,t,o,n,i,r,s,l){this.anchorInlineOffset=e,this.focusInlineOffset=t,this.anchorAlineOffset=o,this.focusAlineOffset=n,this.anchorOffset=i,this.anchorNode=r,this.focusNode=l,this.focusOffset=s},G=function(){function e(e){this.editorHtmlDom=e,this.location=null}return e.prototype.getSelection=function(){var t=e.sel,o=t.anchorNode,n=t.anchorOffset,i=t.focusNode,r=t.focusOffset;if(o&&i){var s=o,l=n;if(s==this.editorHtmlDom)return this.location=null,this.location;for(;s.parentNode!=this.editorHtmlDom;){for(;s.previousSibling;)s=s.previousSibling,H.hasClass(s,"art-shield")||(l+=s.textContent.length);s=s.parentNode}for(var a=i,d=r;a.parentNode!==this.editorHtmlDom;){for(;a.previousSibling;)a=a.previousSibling,H.hasClass(a,"art-shield")||(d+=a.textContent.length);a=a.parentNode}for(var c=-1,h=0;h<this.editorHtmlDom.childNodes.length;h++)if(this.editorHtmlDom.childNodes[h]===s){c=h;break}var u=-1;for(h=0;h<this.editorHtmlDom.childNodes.length;h++)if(this.editorHtmlDom.childNodes[h]===a){u=h;break}var p=o.parentNode.nodeName;0!=n||null!=o.previousSibling||"LI"!=p&&"P"!=p&&"TH"!=p&&"TD"!=p||(o=o.parentNode),this.location=new Q(l,d,c,u,n,o,r,i)}else this.location=null;return this.location},e.prototype.searchNode=function(e,t){if(1==e.childNodes.length&&"#text"==e.childNodes[0].nodeName){if(t<=e.childNodes[0].textContent.length)return[e.childNodes[0],t];t-=e.textContent.length}else for(var o=0;o<e.childNodes.length;o++)if(!H.hasClass(e.childNodes[o],"art-shield")){if(!(e.childNodes[o].textContent.length<t))return"#text"===e.childNodes[o].nodeName?[e.childNodes[o],t]:this.searchNode(e.childNodes[o],t);t-=e.childNodes[o].textContent.length}return 1==t&&e.nextSibling?[e.nextSibling,0]:null},e.prototype.setTool=function(e){for(var t=this.editorHtmlDom.getElementsByClassName("art-tocTool"),o=0;o<t.length;o++)t[o].style.visibility="hidden",t[o].nextSibling.style.borderColor="#9990";if(H.hasClass(e,"art-shield"))return!!H.hasClass(e,"art-toc")&&(e.previousSibling&&H.hasClass(e.previousSibling,"art-tocTool")&&(e.previousSibling.style.visibility="visible",e.style.borderColor="#999"),!0);t=this.editorHtmlDom.getElementsByClassName("art-codeTool");for(o=0;o<t.length;o++)t[o].style.visibility="hidden";t=this.editorHtmlDom.getElementsByClassName("art-tableTool");for(o=0;o<t.length;o++)t[o].style.visibility="hidden";if(ie.plugins.flowchart){t=this.editorHtmlDom.getElementsByClassName("art-flowTool");for(o=0;o<t.length;o++)t[o].style.border="inherit",t[o].previousSibling.style.display="none"}return"PRE"==e.nodeName?(H.hasClass(e.previousSibling,"art-codeTool")&&(e.previousSibling.style.visibility="visible"),ie.plugins.flowchart&&H.hasClass(e,"art-pre-flow")&&(e.style.display="inherit",e.nextSibling.style.border="1px solid #999"),!0):"TABLE"==e.nodeName&&(H.hasClass(e.previousSibling,"art-tableTool")&&(e.previousSibling.style.visibility="visible"),!0)},e.prototype.setSelection=function(t){if(void 0===t&&(t=void 0),null!=typeof t&&t||(t=this.location),!t)return!1;for(var o=this.editorHtmlDom.getElementsByClassName("art-show"),n=o.length-1;n>=0;n--){a=(a=o[n].getAttribute("class")).replace("art-show","art-hide"),o[n].setAttribute("class",a)}if(this.location&&this.location.anchorInlineOffset==this.location.focusInlineOffset&&this.location.anchorAlineOffset==this.location.focusAlineOffset){var i=null,r=this.editorHtmlDom.childNodes[this.location.focusAlineOffset],s=this.location.anchorInlineOffset;if(this.setTool(r),console.log(this.location),/art-shield/.test(r.className))return null;if(i="HR"==r.nodeName?[r,0]:0!=this.location.anchorOffset||"LI"!==this.location.anchorNode.nodeName&&"TH"!==this.location.anchorNode.nodeName&&"P"!==this.location.anchorNode.nodeName&&"TD"!==this.location.anchorNode.nodeName&&"DIV"!==this.location.anchorNode.nodeName?0==this.location.anchorOffset&&this.location.anchorNode.parentNode&&("CODE"==this.location.anchorNode.parentNode.nodeName&&"PRE"==this.location.anchorNode.parentNode.parentNode.nodeName||"CODE"==this.location.anchorNode.nodeName&&"PRE"==this.location.anchorNode.parentNode.nodeName)?[this.location.anchorNode,0]:this.searchNode(r,s):[this.location.anchorNode,0],console.log(i),null===i)return null;var l=this.editorHtmlDom.getElementsByClassName("art-show-math");for(n=l.length-1;n>=0;n--){a=(a=l[n].getAttribute("class")).replace("art-show-math",""),l[n].setAttribute("class",a)}if("#text"==i[0].nodeName&&H.hasClass(i[0].parentNode,"art-math"))(null==(a=i[0].parentNode.previousSibling.childNodes[0].getAttribute("class"))||a.indexOf("art-show-math")<0)&&(a="art-show-math",i[0].parentNode.previousSibling.childNodes[0].setAttribute("class",a));e.setCursor(i[0],i[1]);var a,d=i[0].parentNode;if(d&&H.hasClass(d,"art-hide")&&(d.previousSibling&&H.hasClass(d.previousSibling,"art-text-double")?d=d.previousSibling:d.nextSibling&&H.hasClass(d.nextSibling,"art-text-double")&&(d=d.nextSibling)),d&&H.hasClass(d,"art-text-double"))a=(a=d.nextSibling.getAttribute("class")).replace("art-hide","art-show"),d.nextSibling.setAttribute("class",a),a=(a=d.previousSibling.getAttribute("class")).replace("art-hide","art-show"),d.previousSibling.setAttribute("class",a);if("#text"===i[0].nodeName&&H.hasClass(i[0].parentNode,"art-hide"))a=(a=i[0].parentNode.getAttribute("class")).replace("art-hide","art-show"),i[0].parentNode.setAttribute("class",a)}},e.setCursor=function(t,o){var n=e.sel.getRangeAt(0).cloneRange();n.setStart(t,o),n.collapse(!0),e.sel.removeAllRanges(),e.sel.addRange(n)},e.prototype.moveCursor=function(e){switch(e){case"ArrowRight":this.location.anchorOffset++,this.location.focusOffset++,this.location.anchorInlineOffset++,this.location.focusInlineOffset++;break;default:return!1}return this.setSelection(),!0},e.sel=window.getSelection(),e}(),ee=function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;var n=Array(e),i=0;for(t=0;t<o;t++)for(var r=arguments[t],s=0,l=r.length;s<l;s++,i++)n[i]=r[s];return n},te=window,oe=function(){function e(e){this.artText=e,this.editorDom=null,this.htmlNode=null,this.mdDom=null,this.fileInfo={name:null},this.cursor=null}return e.setPlugin=function(t,o,n){if(void 0===n&&(n=null),e.plugins[t]=o,null==n)return null;n?(n.cursor.getSelection(),n.render()):fe.artTextsRender()},e.prototype.init=function(){this.createEditor(),this.cursor=new G(this.htmlNode.dom),H.addCss(ne.replace("${theme.backgroundColor}",this.artText.options.theme.backgroundColor)),this.registerPlugin(),this.setMd(this.artText.options.markdown)},e.prototype.registerPlugin=function(){var t=this;if(this.artText.options.code.jsFun?e.setPlugin("hljs",this.artText.options.code.jsFun):this.artText.options.code.js&&H.loadScript(this.artText.options.code.js,(function(){e.setPlugin("hljs",te.hljs,t)})),null!=this.artText.options.math.jsFun?e.setPlugin("katex",this.artText.options.math.jsFun):this.artText.options.math.js&&H.loadScript(this.artText.options.math.js,(function(){e.setPlugin("katex",te.katex,t)})),this.artText.options.math.css&&H.loadCss(this.artText.options.math.css),this.artText.options.flowchart.jsFun)e.setPlugin("flowchart",this.artText.options.flowchart.jsFun);else if(this.artText.options.flowchart.js){H.loadScript(this.artText.options.flowchart.js[0],(function(){e.setPlugin("Raphael",te.Raphael,void 0),H.loadScript(t.artText.options.flowchart.js[1],(function(){e.setPlugin("flowchart",te.flowchart,t)}))}))}},e.prototype.createEditor=function(){this.editorDom=document.createElement("div"),this.editorDom.setAttribute("class","art-editor"),this.htmlNode=new I("div",{__root__:!0,contenteditable:"true",class:"art-editor-html",style:"outline:none;white-space:pre-wrap;word-break:break-all"},new I("p",{},new I("br"))),this.htmlNode.newDom(),this.mdDom=document.createElement("textarea"),this.mdDom.setAttribute("class","art-editor-md"),this.mdDom.setAttribute("style","width:100%;min-height:200px;border:none;outline:none;resize:none;display:none"),this.mdDom.addEventListener("input",(function(e){e.target.style.height=this.scrollHeight+"px"})),this.editorDom.appendChild(this.htmlNode.dom),this.editorDom.appendChild(this.mdDom),this.artText.rootDom.appendChild(this.editorDom)},e.prototype.click=function(e){void 0===e&&(e="left"),this.cursor.getSelection(),"right"==e?this.artText.tool.setFloatAuxiliaryTool("show"):(this.cursor.location&&this.cursor.location.anchorInlineOffset!=this.cursor.location.focusInlineOffset&&this.cursor.location.anchorAlineOffset==this.cursor.location.focusAlineOffset?this.artText.tool.setFloatToolbar("show"):this.artText.tool.setFloatToolbar("hide"),this.artText.tool.setFloatAuxiliaryTool("hide")),this.cursor.setSelection()},e.prototype.backRender=function(){var e=this.cursor.getSelection();if(e)if("PRE"==this.htmlNode.dom.childNodes[e.anchorAlineOffset].nodeName){if(null==e.anchorNode.previousSibling&&0==e.anchorInlineOffset)return!1}else console.log("无执行",e);return!0},e.prototype.enterRender=function(){var e=this.cursor.getSelection();if(e){this.htmlNode.replaceAllChild(W(this.htmlNode.dom).childNodes);var t=this.htmlNode.childNodes[e.anchorAlineOffset].getMd(),o=this.htmlNode.dom.childNodes[e.anchorAlineOffset];if(/^(\*{3,}$|^\-{3,}$|^\_{3,}$)/.test(t)){var n=document.createElement("hr");return this.htmlNode.dom.replaceChild(n,o),G.setCursor(n,0),!1}if(/^\[(TOC)|(toc)\]$/.test(t)){var i=document.createElement("div");i.setAttribute("class","art-shield art-toc"),i.setAttribute("contenteditable","false");var r=document.createElement("div");return r.setAttribute("class","art-shield art-tocTool"),r.setAttribute("contenteditable","false"),j(r),(A=document.createElement("p")).innerHTML="<br/>",o.nextSibling?o.parentNode.insertBefore(A,o.nextSibling):o.parentNode.appendChild(A),this.htmlNode.dom.replaceChild(i,o),this.htmlNode.dom.insertBefore(r,i),this.updateToc(),G.setCursor(A,0),!1}if(/^\|.*\|/.test(t)){var s=document.createElement("table"),a=document.createElement("thead"),d=document.createElement("tbody");s.appendChild(a),s.appendChild(d),s.style.width="100%";for(var c=document.createElement("tr"),h=document.createElement("tr"),p=t.split("|"),f=1,m=p.length-1;f<m;f++){var g=document.createElement("th");g.innerHTML=p[f],c.appendChild(g),h.appendChild(document.createElement("td"))}return a.appendChild(c),d.appendChild(h),(v=document.createElement("div")).setAttribute("class","art-shield art-tableTool"),v.setAttribute("contenteditable","false"),l(v),this.htmlNode.dom.replaceChild(s,this.htmlNode.dom.childNodes[e.anchorAlineOffset]),this.htmlNode.dom.insertBefore(v,s),G.setCursor(h.childNodes[0],0),!1}if(/^```/.test(t)){var N=document.createElement("pre"),y=document.createElement("code");y.innerHTML="\n";var v,b=t.match(/^```\s*([^\s]*?)\s*$/)[1];if((v=document.createElement("div")).setAttribute("class","art-shield art-codeTool"),v.setAttribute("contenteditable","false"),null!=b&&""!=b){if(y.setAttribute("class","lang-"+b),N.setAttribute("class","art-pre-"+b),"flow"==b){var x=document.createElement("div");x.setAttribute("class","art-shield art-flowTool"),x.setAttribute("art-flow",""),x.setAttribute("contenteditable","false"),this.htmlNode.dom.insertBefore(x,this.htmlNode.dom.childNodes[e.anchorAlineOffset].nextSibling)}u(v,b)}else u(v);return N.appendChild(y),this.htmlNode.dom.replaceChild(N,this.htmlNode.dom.childNodes[e.anchorAlineOffset]),this.htmlNode.dom.insertBefore(v,N),G.setCursor(y,0),!1}if("BLOCKQUOTE"==e.anchorNode.parentNode.nodeName&&0==e.anchorOffset&&"P"==e.anchorNode.nodeName&&1==e.anchorNode.childNodes.length&&"BR"==e.anchorNode.childNodes[0].nodeName){var w=e.anchorNode;return(A=document.createElement("p")).innerHTML="<br/>",w.parentNode.nextSibling?w.parentNode.parentNode.insertBefore(A,w.parentNode.nextSibling):w.parentNode.parentNode.appendChild(A),w.parentNode.removeChild(w),G.setCursor(A,0),!1}if("BLOCKQUOTE"==e.anchorNode.parentNode.parentNode.nodeName&&null==e.anchorNode.nextSibling&&e.anchorOffset==e.anchorNode.length){var T=e.anchorNode;return(A=document.createElement("p")).innerHTML="<br/>",T.parentNode.nextSibling?T.parentNode.parentNode.insertBefore(A,T.parentNode.nextSibling):T.parentNode.parentNode.appendChild(A),G.setCursor(A,0),!1}if(0==e.anchorOffset&&"LI"==e.anchorNode.nodeName&&1==e.anchorNode.childNodes.length&&"BR"==e.anchorNode.childNodes[0].nodeName){var C=e.anchorNode;return(A=document.createElement("p")).innerHTML="<br/>",C.parentNode.nextSibling?C.parentNode.parentNode.insertBefore(A,C.parentNode.nextSibling):C.parentNode.parentNode.appendChild(A),C.parentNode.removeChild(C),G.setCursor(A,0),!1}if("P"==e.anchorNode.parentNode.nodeName&&"LI"==e.anchorNode.parentNode.parentNode.nodeName){var A,E=e.anchorNode;return(A=document.createElement("p")).innerHTML="<br/>",E.parentNode.nextSibling?E.parentNode.parentNode.insertBefore(A,E.parentNode.nextSibling):E.parentNode.parentNode.appendChild(A),G.setCursor(A,0),!1}if("P"==e.anchorNode.nodeName&&"LI"==e.anchorNode.parentNode.nodeName&&1==e.anchorNode.childNodes.length&&"BR"==e.anchorNode.childNodes[0].nodeName){var k=e.anchorNode,S=document.createElement("li");return S.innerHTML="<br/>",k.parentNode.nextSibling?k.parentNode.parentNode.insertBefore(S,k.parentNode.nextSibling):k.parentNode.parentNode.appendChild(S),k.parentNode.removeChild(k),G.setCursor(S,0),!1}if("PRE"==o.nodeName){var _=e.anchorNode.nodeValue;return console.log(_),_=_.substring(0,e.anchorOffset)+"\n\r"+_.substring(e.anchorOffset),e.anchorNode.nodeValue=_,G.setCursor(e.anchorNode,e.anchorOffset+1),!1}console.log("无执行",e)}return!0},e.prototype.nodeRender=function(t,o){if(t.nodeName.toLowerCase()==o.nodeName){if("code"==o.nodeName){for(var n in!t.getAttribute("style")||null!=o.attr.style&&o.attr.class||t.setAttribute("style",""),o.attr)/^__[a-zA-Z\d]+__$/.test(n)||t.setAttribute(n,o.attr[n]);var i=o.getMd();if(e.plugins.hljs&&"pre"==o.parentNode.nodeName){var r=o.attr.class;r||(r="");var s=r.match(/lang-(.*?)(\s|$)/);if(s&&null!=e.plugins.hljs.getLanguage(s[1]))i=e.plugins.hljs.highlight(s[1],i).value;else{var a=e.plugins.hljs.highlightAuto(i);i=a.value,t.className.match(a.language)||(t.className+=" "+a.language)}}return t.innerHTML=i,null}if(H.hasClass(t,"art-shield")){var d=!0;if(o.hasClass("art-flowTool")&&e.plugins.flowchart&&e.plugins.Raphael){t.innerHTML="";i=t.previousSibling.innerText;try{e.plugins.flowchart.parse(i).drawSVG(t),t.previousSibling.style.display="none",t.onclick=function(){H.hasClass(this,"art-flowTool")&&(this.previousSibling.style.display="inherit"),G.setCursor(this.previousSibling,0)}}catch(e){console.error("flowchart发生错误"),console.error(e)}}else if("math"==o.attr.__dom__&&e.plugins.katex){var c=t.childNodes[0].getAttribute("art-math");c&&o.childNodes[0].attr["art-math"]!=c&&(t.childNodes[0].innerHTML=e.plugins.katex.renderToString(o.childNodes[0].attr["art-math"],{throwOnError:!1}),t.childNodes[0].setAttribute("art-math",o.childNodes[0].attr["art-math"]))}else if("tocTool"==o.attr.__dom__)j(t),d=!1;else if("codeTool"==o.attr.__dom__)u(t,o.attr.__dict__.codeLang),d=!1;else if("tableTool"==o.attr.__dom__)l(t),d=!1;else if(H.hasClass(t,"art-toc"))for(var h=0,p=0;h<t.childNodes.length||p<o.childNodes.length;h++,p++)if(h>=t.childNodes.length)t.appendChild(o.childNodes[p].newDom());else if(p>=o.childNodes.length)for(var f=t.childNodes.length;h<f;)t.removeChild(t.lastChild),h++;else this.nodeRender(t.childNodes[h],o.childNodes[p]);for(var n in!d||!t.getAttribute("style")||null!=o.attr.style&&o.attr.class||t.setAttribute("style",""),o.attr)/^__[a-zA-Z\d]+__$/.test(n)||t.setAttribute(n,o.attr[n])}else{for(var n in!t.getAttribute("style")||null!=o.attr.style&&o.attr.class||t.setAttribute("style",""),o.attr)/^__[a-zA-Z\d]+__$/.test(n)||t.setAttribute(n,o.attr[n]);for(h=0,p=0;h<t.childNodes.length||p<o.childNodes.length;h++,p++)if(h>=t.childNodes.length)t.appendChild(o.childNodes[p].newDom());else if(p>=o.childNodes.length)for(f=t.childNodes.length;h<f;)t.removeChild(t.lastChild),h++;else"#text"==o.childNodes[p].nodeName?"#text"==t.childNodes[h].nodeName.toLowerCase()?o.childNodes[p].text!=t.childNodes[h].nodeValue&&(t.childNodes[h].nodeValue=o.childNodes[p].text):t.parentNode.replaceChild(o.newDom(),t):this.nodeRender(t.childNodes[h],o.childNodes[p])}}else t.parentNode.replaceChild(o.newDom(),t);return null},e.prototype.dispose=function(e,t){if(void 0===t&&(t=null),null!=t){var o=function(e){if(null==e)return null;for(var t,o=e.split("\n"),n=[],i=0,r=o.length;i<r;i++)if(/^>\s/.test(o[i])){for(t=[];i<r&&/^>\s/.test(o[i]);)t.push(Z(o[i])),i++;i<r&&/^\s*$/.test(o[i+1])||i--,n.push(J(new I("blockquote",{},t)))}else if(/^\*\s/.test(o[i])){for(t=[];i<r&&/^\*\s/.test(o[i]);)t.push(U(o[i],"ul")),i++;i<r&&/^\s*$/.test(o[i+1])||i--,n.push(J(new I("ul",{},t)))}else if(/^\d\.\s/.test(o[i])){for(t=[];i<r&&(/^\d\.\s/.test(o[i])||/^\s{3,}\*\s/.test(o[i]));)t.push(U(o[i],"ol")),i++;i<r&&/^\s*$/.test(o[i+1])||i--,n.push(J(new I("ol",{},t)))}else if(/^```/.test(o[i])){var l=o[i].match(/^```\s*([^\s]*?)\s*$/)[1],a=void 0,d=!1,c="";for(a=i+1;a<r;a++){if(/^```$/.test(o[a])){d=!0;break}c+=o[a]+"\n"}if(d){i=a;var h=void 0;null!=l&&null!=l||(l=""),n.push(new I("div",{class:"art-shield art-codeTool",contenteditable:"false",__dom__:"codeTool",__dict__:{codeLang:l}})),""!=l?(h=new I("code",{class:"lang-"+l},new s(c)),n.push(new I("pre",{class:"art-pre-"+l},h)),"flow"==l&&n.push(new I("div",{class:"art-shield art-flowTool",contenteditable:"false"},[]))):(h=new I("code",{},new s(c)),n.push(new I("pre",{},h))),i+1<r&&/^\s*$/.test(o[i+1])&&i++}else n.push(new I("p",{},new s(o[i]))),i+1<r&&""==o[i+1]&&i++}else if(/^\|.*\|/.test(o[i])){var u=void 0,p=(a=void 0,void 0),f=[],m=void 0;if(i+1<r&&/^\|(\s*-{3,}\s*\|)+/.test(o[i+1])){for(t=[],a=1,p=(u=o[i].split("|")).length-1;a<p;a++)f.push(new I("th",{},V(u[a])));for(t.push(new I("thead",{},new I("tr",{},f))),i+=2,m=[];i<r&&/^\|.*\|/.test(o[i]);){for(f=[],a=1,p=(u=o[i].split("|")).length-1;a<p;a++)f.push(new I("td",{},V(u[a])));m.push(new I("tr",{},f)),i++}i<r&&/^\s*$/.test(o[i+1])||i--,n.push(new I("div",{class:"art-shield art-tableTool",contenteditable:"false",__dom__:"tableTool"})),t.push(new I("tbody",{},m)),n.push(new I("table",{style:"width:100%;"},t))}else n.push(new I("p",{},V(o[i]))),i+1<r&&/^\s*$/.test(o[i+1])&&i++}else/^(\*{3,}$|^\-{3,}$|^\_{3,}$)/.test(o[i])?(n.push(new I("hr")),i+1<r&&/^\s*$/.test(o[i+1])&&i++):/^\[(TOC)|(toc)\]$/.test(o[i])?(n.push(new I("div",{class:"art-shield art-tocTool",contenteditable:"false",__dom__:"tocTool"})),n.push(new I("div",{class:"art-shield art-toc",contenteditable:"false",__dom__:"toc"})),i+1<r&&/^\s*$/.test(o[i+1])&&i++):(t=X(o[i]))?(t.forEach((function(e){n.push(e)})),i+1<r&&/^\s*$/.test(o[i+1])&&i++):(n.push(new I("p",{},V(o[i]))),i+1<r&&/^\s*$/.test(o[i+1])&&i++);return n}(t);if(o){e.childNodes=[];for(var n=0;n<o.length;n++)e.appendChild(o[n])}return null}if(1==e.attr.__root__)for(n=e.childNodes.length-1;n>=0;n--){if((c=this.dispose(e.childNodes[n]))&&c.length>0){e.removeChild(e.childNodes[n]);for(var i=e.childNodes[n],r=0,l=c;r<l.length;r++){var a=l[r];e.insertBefore(a,i)||e.appendChild(a)}}}else{if(e.attr.class&&e.attr.class.match(/art-shield/))return null;if("blockquote"==e.nodeName)for(n=0;n<e.childNodes.length;n++)"blockquote"==e.childNodes[n].nodeName||"ul"==e.childNodes[n].nodeName||"ol"==e.childNodes[n].nodeName?this.dispose(e.childNodes[n]):/^>\s/.test(e.childNodes[n].getMd())?e.replaceChild(new I("blockquote",{},new I("p",{},new I("br"))),e.childNodes[n]):/^\*\s/.test(e.childNodes[n].getMd())?e.replaceChild(new I("ul",{},new I("li",{},new I("br"))),e.childNodes[n]):/^\d\.\s/.test(e.childNodes[n].getMd())?e.replaceChild(new I("ol",{},new I("li",{},new I("br"))),e.childNodes[n]):e.childNodes[n].replaceAllChild(V(e.childNodes[n].getMd()));else if("ul"===e.nodeName||"ol"===e.nodeName)for(n=0;n<e.childNodes.length;n++)if("blockquote"==e.childNodes[n].childNodes[0].nodeName||"ul"==e.childNodes[n].childNodes[0].nodeName||"ol"==e.childNodes[n].childNodes[0].nodeName)for(var d=0;d<e.childNodes[n].childNodes.length;d++)"p"==e.childNodes[n].childNodes[d].nodeName?e.childNodes[n].childNodes[d].replaceAllChild(V(e.childNodes[n].childNodes[d].getMd())):this.dispose(e.childNodes[n].childNodes[d]);else/^>\s/.test(e.childNodes[n].getMd())?e.childNodes[n].replaceAllChild([new I("blockquote",{},new I("p",{},new I("br")))]):/^\*\s/.test(e.childNodes[n].getMd())?e.childNodes[n].replaceAllChild([new I("ul",{},new I("li",{},new I("br")))]):/^\d\.\s/.test(e.childNodes[n].getMd())?e.childNodes[n].replaceAllChild([new I("ol",{},new I("li",{},new I("br")))]):"input"==e.childNodes[n].childNodes[0].nodeName?e.childNodes[n].replaceAllChild(ee([e.childNodes[n].childNodes[0]],V(e.childNodes[n].getMd()))):/^\[x|X\]\s/.test(e.childNodes[n].getMd())?e.childNodes[n].replaceAllChild(ee([new I("input",{type:"checkbox",checked:"checked"})],V(e.childNodes[n].getMd().substring(4)))):/^\[\s\]\s/.test(e.childNodes[n].getMd())?e.childNodes[n].replaceAllChild(ee([new I("input",{type:"checkbox"})],V(e.childNodes[n].getMd().substring(4)))):e.childNodes[n].replaceAllChild(V(e.childNodes[n].getMd()));else{var c;if("table"!=e.nodeName)return"pre"===e.nodeName||"hr"==e.nodeName?null:(c=X(e.getMd()))||[new I("p",{},V(e.getMd()))];for(n=0;n<e.childNodes.length;n++)for(d=0;d<e.childNodes[n].childNodes.length;d++)for(var h=e.childNodes[n].childNodes[d],u=0;u<h.childNodes.length;u++)h.childNodes[u].replaceAllChild(V(h.childNodes[u].getMd()))}}return null},e.prototype.render=function(){this.htmlNode.replaceAllChild(W(this.htmlNode.dom).childNodes),this.dispose(this.htmlNode),this.updateToc(),this.nodeRender(this.htmlNode.dom,this.htmlNode),this.cursor.setSelection()},e.prototype.updateToc=function(){for(var e=[],t=[],o=0,n=this.htmlNode.childNodes;o<n.length;o++){var i=n[o];if(/^h\d$/.test(i.nodeName)){var r=i.getMd();r=r.replace(/\s/g,"-").replace(/\\|\/|#|\:/g,"");var l=new I("a",{href:"#"+r},new s(i.getText())),a=new I("p",{class:"art-toc-"+i.nodeName},l);t.push(a)}else i instanceof I&&i.attr.class&&/art-toc(\s|$)/.test(i.attr.class)&&e.push(i)}for(var d=0,c=e;d<c.length;d++){c[d].childNodes=t}},e.prototype.getMd=function(){for(var e="",t=0;t<this.htmlNode.childNodes.length;t++){var o=this.htmlNode.childNodes[t].getMd("read");o&&(e+=o+"\n")}return e},e.prototype.setMd=function(e){this.dispose(this.htmlNode,e),this.updateToc(),this.nodeRender(this.htmlNode.dom,this.htmlNode)},e.prototype.openFile=function(e,t){console.log("'"+e+"', '"+t+"'"),this.fileInfo.name=t,this.setMd(e)},e.prototype.openTextarea=function(){this.htmlNode.dom.style.display="none",this.mdDom.style.display="inline",this.mdDom.value=this.getMd(),this.mdDom.style.height=this.mdDom.scrollHeight+5+"px"},e.prototype.closeTextarea=function(){this.htmlNode.dom.style.display="inline",this.setMd(this.mdDom.value),this.mdDom.style.display="none"},e.prototype.emptyEditor=function(){"none"==this.htmlNode.dom.style.display?(this.mdDom.value="",this.mdDom.style.height="auto"):this.setMd("")},e.plugins={hljs:null,katex:null,flowchart:null,Raphael:null},e}(),ne="\n.art-hide{display: inline-block;width: 0;height: 0;overflow: hidden;vertical-align: middle;}\n.art-show{color: #ccc;}\n.art-editor-html pre code{white-space: pre-wrap;}\n.art-show-math{position: absolute;padding: 13px 25px;background: #fff;box-shadow: rgba(0, 0, 0, 0.1) 0px 2px 12px 0px;}\n.art-editor{box-shadow:0 2px 12px 0 rgba(0, 0, 0, 0.1);padding:30px 25px;border-radius:4px;background-color:${theme.backgroundColor};",ie=oe,re={markdown:"",runModel:"editor",securityLevel:"strict",math:{name:"katex",js:"https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.js",css:"https://cdn.jsdelivr.net/npm/katex@0.10.1/dist/katex.min.css"},code:{name:"hljs",js:"https://libs.cdnjs.net/highlight.js/10.1.2/highlight.min.js",css:null},flowchart:{js:["https://cdnjs.cloudflare.com/ajax/libs/raphael/2.3.0/raphael.min.js","https://cdnjs.cloudflare.com/ajax/libs/flowchart/1.14.0/flowchart.min.js"],css:null},theme:{backgroundColor:"#fff",color:"#1abc9c"}},se=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s};function le(e){return void 0===e&&(e=""),function(t,o,n){var i=n.value;return n.value=function(){var t=null;this instanceof fe?t=this:null!=this.artText&&this.artText&&(t=this.artText),t&&t.eventCenter.executeFutureEvent(e+"-start-"+o),i.apply(this,arguments),t&&t.eventCenter.executeFutureEvent(e+"-end-"+o)},n}}var ae=function(){function e(e){this.artText=e,this.editorHtmlDom=null,this.uploadImg=null,this.clickInfo=null,this.isComposition=!1,this.futureEvent=new Map,this.observer=new MutationObserver(this.observerCallback),this.eventListeners=[]}return e.prototype.init=function(){this.editorHtmlDom=this.artText.editor.htmlNode.dom,this.addEventListener("keydown",this.keydown),this.addEventListener("keyup",this.keyup),this.addEventListener("compositionstart",(function(e,t){t.isComposition=!0})),this.addEventListener("compositionend",(function(e,t){t.isComposition=!1})),this.addEventListener("click",this.click),this.addEventListener("contextmenu",this.contextmenu),this.addEventListener("mousedown",this.mousedown),this.addEventListener("paste",this.paste),this.addEventListener("drop",this.drop)},e.prototype.observerCallback=function(e,t){for(var o=0,n=e;o<n.length;o++){var i=n[o];"childList"==i.type?console.log("A child node has been added or removed."):"attributes"==i.type&&console.log("The "+i.attributeName+" attribute was modified.")}},e.prototype.addFutureEvent=function(e,t){this.futureEvent.has(e)?this.futureEvent.get(e).push(t):this.futureEvent.set(e,[t])},e.prototype.executeFutureEvent=function(e){if(this.futureEvent.has(e)){for(var t=this.futureEvent.get(e),o=t.length-1;o>=0;o--)t[o]();this.futureEvent.set(e,[])}},e.prototype.addEventListener=function(e,t,o){void 0===o&&(o=!1);var n=this;function i(e){n.artText.editor.cursor.getSelection(),t(e,n)}this.editorHtmlDom.addEventListener(e,i,o),this.eventListeners.push([e,i,o])},e.prototype.removeEventListener=function(e,t,o){void 0===o&&(o=!1),this.editorHtmlDom.removeEventListener(e,t,o)},e.prototype.removeAllEventListener=function(){for(var e=0,t=this.eventListeners;e<t.length;e++){var o=t[e];this.removeEventListener(o[0],o[1],o[2])}},e.prototype.keydown=function(e,t){var o=e.key;if(!t.shortcutKey(e,t.artText))return!1;if(/^Arrow(Right|Left|Up|Down)$/.test(o)&&t.artText.editor.cursor.moveCursor(o))return e.preventDefault(),!1;if("Enter"==o){if(!t.artText.editor.enterRender())return e.preventDefault(),!1}else if("Backspace"==o&&!t.artText.editor.backRender())return e.preventDefault(),!1;return!0},e.prototype.shortcutKey=function(e,t){if(e.ctrlKey&&66==e.keyCode)w(t);else if(e.ctrlKey&&73==e.keyCode)T(t);else if(e.ctrlKey&&e.shiftKey&&68==e.keyCode)C(t);else if(e.ctrlKey&&85==e.keyCode)A(t);else if(e.ctrlKey&&e.altKey&&83==e.keyCode)E(t);else if(e.ctrlKey&&e.shiftKey&&83==e.keyCode)k(t);else{if(!e.ctrlKey||77!=e.keyCode)return!0;!function(e){S(e,"==")}(t)}return!1},e.prototype.keyup=function(e,t){"Backspan"==e.key&&""==t.editorHtmlDom.innerHTML&&(t.editorHtmlDom.innerHTML="<div><p><br/></p></div>"),t.isComposition||t.artText.editor.render()},e.prototype.click=function(e,t){var o=e.target;if(e.altKey&&"A"==o.nodeName)window.open(o.href);else{var n=t.artText.editor.cursor;n.location&&n.location.anchorInlineOffset!=n.location.focusInlineOffset&&n.location.anchorAlineOffset==n.location.focusAlineOffset?t.artText.tool.setFloatToolbar("show"):t.artText.tool.setFloatToolbar("hide"),t.artText.tool.setFloatAuxiliaryTool("hide"),n.setSelection()}},e.prototype.contextmenu=function(e,t){e.preventDefault(),t.artText.tool.setFloatAuxiliaryTool("show")},e.prototype.mousedown=function(e,t){var o=new Map;o.pageX=e.pageX,o.pageY=e.pageY,o.offsetX=e.offsetX,o.offsetY=e.offsetY,t.clickInfo=o},e.prototype.paste=function(e,t){if(e.clipboardData&&e.clipboardData.items){for(var o=null,n=0,i=e.clipboardData.items.length;n<i;n++){var r=e.clipboardData.items[n];if("string"===r.kind)if("text/plain"==r.type)o=["text/plain",r];else if("text/html"==r.type){o=["text/html",r];break}}if(o&&"text/html"==o[0]){var s=t.getAsString(t);return o[1].getAsString(s),!1}}},e.prototype.getAsString=function(e){return function(t){var o=document.createElement("html");o.innerHTML=t;var n=o.childNodes[1],i=e.artText.editor.cursor.location;console.log(i);var r=function e(t){var o="";if("DIV"==t.nodeName||"P"==t.nodeName){for(var n=0;n<t.childNodes.length;n++)o+=e(t.childNodes[n]);o+="\n"}else if("UL"==t.nodeName)for(n=0;n<t.childNodes.length;n++)o+="* "+e(t.childNodes[n])+"\n";else if("OL"==t.nodeName)for(n=0;n<t.childNodes.length;n++)o+=(n+1).toString()+". "+e(t.childNodes[n])+"\n";else if("BLOCKQUOTE"==t.nodeName)for(n=0;n<t.childNodes.length;n++)o+="> "+e(t.childNodes[n])+"\n";else if("TABLE"==t.nodeName)for(n=0;n<t.childNodes.length;n++)o+="> "+e(t.childNodes[n])+"\n";else if(/^H\d$/.test(t.nodeName)){o+="#".repeat(t.nodeName[1])+" ";for(n=0;n<t.childNodes.length;n++)o+=e(t.childNodes[n]);o+="\n"}else if("A"==t.nodeName)o+="["+e(t.childNodes[0])+"]("+t.href+")";else if("IMG"==t.nodeName)o+="!["+t.alt+"]("+t.src+")";else if("#text"==t.nodeName)o+=t.data;else{var i=!0;for(n=0;n<$.length;n++)if(t.nodeName.toLowerCase()==$[n].tag){o+=$[n].left;for(var r=0;r<t.childNodes.length;r++)o+=e(t.childNodes[r]);o+=$[n].right,i=!1;break}for(n=0;i&&n<t.childNodes.length;n++)o+=e(t.childNodes[n])}return o}(n);console.log(r);for(var s=(r=r.replace(/(^\s*)|(\s*$)/g,"")).split("\n"),l=i[2],a=0;a<s.length;a++)0==a?(console.log(l),e.editorHtmlDom.childNodes[l].appendChild(document.createTextNode(s[a])),l++):(console.log(l),e.editorHtmlDom.insertBefore(document.createTextNode(s[a]),e.editorHtmlDom.childNodes[l]),l++)}},e.prototype.drop=function(e,t){e.preventDefault();for(var o=0,n=e.dataTransfer.files.length;o<n;o++){var i=e.dataTransfer.files[o],r=new FileReader;console.log(r,i),/.*\.md$/.test(i.name)||"text/plain"==i.type?(r.onload=function(){r.result&&t.artText.editor.openFile(r.result.toString(),i.name)},r.readAsText(i)):/^image\/(png|jpe?g)$/.test(i.type)?(r.onload=function(){var o=null;o=t.uploadImg?t.uploadImg(r.result):r.result;var n=new Image;n.src=o,console.log(n);var s=document.createElement("span");s.setAttribute("class","art-hide");var l=document.createTextNode("!["+i.name+"]("+o+")");s.appendChild(l);var a=e.target;a.appendChild(s),a.appendChild(n)},r.readAsDataURL(i)):H.message("不支持该文件类型","error")}},se([le("EventCenter")],e.prototype,"init",null),e}();function de(e,t){var o=document.createElement("a");o.download=t,o.style.display="none";var n=new Blob([e]);o.href=URL.createObjectURL(n),document.body.appendChild(o),o.click(),document.body.removeChild(o)}var ce={plugin:de,options:{name:"exportMdFile",init:function(e){function t(){de(e.editor.getMd(),"123.md")}function o(){!function(e){var t=document.createElement("input");t.type="file",t.accept=".md",t.style.display="none",document.body.appendChild(t),t.click(),t.onchange=function(){var o=new FileReader;o.onload=function(){console.log(o.result.toString()),e.editor.openFile(o.result.toString(),t.files[0].name),console.log(e.editor.htmlNode)},o.readAsText(t.files[0],"utf8")},document.body.removeChild(t)}(e)}e.eventCenter.addFutureEvent("-end-init",(function(){e.tool.addTool("导入",o),e.tool.addTool("导出",t)}))}}},he=function(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var l=e.length-1;l>=0;l--)(i=e[l])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s},ue=window,pe=function(){function e(t,o){void 0===o&&(o={}),this.rootDom=t,this.options=Object.assign({},re,o),this.editor=new ie(this),this.tool=new H(this),this.eventCenter=new ae(this),e.artTexts.push(this)}return e.use=function(e,t){this.plugins.push({plugin:e,options:t})},e.artTextsRender=function(){for(var t=0,o=e.artTexts;t<o.length;t++){o[t].editor.render()}},e.prototype.init=function(){this.registerPlugin(),this.editor.init(),this.tool.init(),this.eventCenter.init(),"editor"!=this.options.runModel&&this.changeRunModel(this.options.runModel)},e.prototype.registerPlugin=function(){for(var t=0;t<e.plugins.length;t++)null!=e.plugins[t].options.init&&e.plugins[t].options.init&&e.plugins[t].options.init(this)},e.prototype.changeRunModel=function(e){var t=this.options.runModel;"read-noStyle"==e?(this.rootDom.childNodes.forEach((function(e){e.style.display="none"})),this.editor.editorDom.style.display="inherit",this.editor.editorDom.setAttribute("class","art-editor-noStyle"),this.editor.editorDom.childNodes.forEach((function(e){e.style.display="none"})),this.editor.htmlNode.dom.style.display="inherit",this.editor.htmlNode.dom.setAttribute("contenteditable","false"),this.eventCenter.removeAllEventListener()):"editor"!=t&&(this.rootDom.childNodes.forEach((function(e){e.style.display="inherit"})),this.editor.editorDom.setAttribute("class","art-editor"),this.editor.editorDom.childNodes.forEach((function(e){e.style.display="inherit"})),this.editor.htmlNode.dom.setAttribute("contenteditable","true"),this.eventCenter.init()),this.options.runModel=e},e.version="0.0.0",e.Editor=ie,e.plugins=[ce],e.artTexts=[],he([le()],e.prototype,"init",null),e}();ue.ArtText=pe;var fe=t.default=pe}]);